import{r,j as s}from"./index-Df1GGLGo.js";import{b as de,o as fe}from"./NewLight-DRceV-Rt.js";import{C as Me}from"./chevron-up-CrOrG4Ys.js";import{N as _e}from"./MobileNavbar-D6rDWjeS.js";import"./createLucideIcon-BrU3YMJI.js";import"./x-BdSaxv1k.js";const $e=768,te=24,ke=16,G=1.25;function Ye({items:c=[],backgroundUrl:a,overlayUrl:f,color:u="#3ca6a6",progressColor:h,dotSize:g=12,cardWidth:x=420,className:j="",pushFactor:Y=.47}){const p=r.useRef(null),w=r.useRef([]),L=r.useRef(null),[D,O]=r.useState(0),[E,S]=r.useState(x),[b,y]=r.useState(0),[A,W]=r.useState(0),[z,me]=r.useState(0),v=r.useRef(!1),m=r.useRef(null),[pe,we]=r.useState(!1),[ge,xe]=r.useState(!0),[q,X]=r.useState(!1),P=r.useRef(0),oe=r.useRef(0),B=r.useRef(0),U=r.useRef(0),T=r.useRef(null),be=r.useRef(null),[ve,se]=r.useState(!1),H=r.useRef(null),[N,ye]=r.useState(!1),Z=He(g,te),Te=.22,Re=.28,ce=h||u,C=6,ie=2,Ee=48,Ne=36;r.useEffect(()=>()=>{H.current&&clearTimeout(H.current)},[]),r.useEffect(()=>{if(!L.current)return;const e=L.current,t=new ResizeObserver(o=>{const i=o[0].contentRect;y(i.height||0)});t.observe(e);const n=e.getBoundingClientRect();return y(n.height||0),()=>t.disconnect()},[E,c.length]),r.useEffect(()=>{function e(){const t=p.current,n=window.innerHeight;if(!t||!n)return;const o=t.getBoundingClientRect(),i=Math.max(0,t.scrollHeight-n),l=ne(-o.top,0,i),d=n/2,R=Math.max(0,d-l);W(R),me(Math.max(0,Math.min(d,d-R)));const _=window.innerWidth,$=_<$e;ye($),S(Pe(_,x,{isNarrow:$,mobileLeftReserve:Z,rightGutter:ke})),we(window.scrollY>100);const k=window.scrollY<=ie;xe(k),k&&q&&X(!1),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{v.current=!1;const le=T.current;if(Number.isInteger(le)){T.current=null,M(le);return}const Ie=he(w.current,n);Le(Ie,n)},140)}return e(),window.addEventListener("scroll",e,{passive:!0}),window.addEventListener("resize",e),window.addEventListener("orientationchange",e),()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e),m.current&&clearTimeout(m.current)}},[x,q,Z]),r.useEffect(()=>{const e=t=>{const n=t.key;if(n!=="ArrowDown"&&n!=="PageDown"&&n!=="ArrowUp"&&n!=="PageUp")return;const o=p.current?.getBoundingClientRect();if(!(o&&o.top<window.innerHeight&&o.bottom>0)||(t.preventDefault(),v.current))return;const l=o.top>C,d=Math.abs(o.top)<=C;return n==="ArrowUp"||n==="PageUp"?d?F(!0):I(-1):l?Q(o.top):I(1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[c.length]);const je=40,Se=120,K=r.useRef(0),J=r.useRef(0);r.useEffect(()=>{const e=t=>{const n=p.current?.getBoundingClientRect();if(!n||!(n.top<window.innerHeight&&n.bottom>0))return;if(v.current){t.preventDefault();return}const i=Math.abs(t.deltaY),l=t.timeStamp||performance.now(),d=J.current?l-J.current:16;J.current=l;const R=1-Math.exp(-d/Se);if(K.current=(1-R)*K.current+R*i,K.current<=je){t.preventDefault(),P.current=0;return}if(P.current+=t.deltaY,Math.abs(P.current)<Ee){t.preventDefault();return}const _=P.current>0;P.current=0,t.preventDefault();const $=n.top>C,k=Math.abs(n.top)<=C;return _?$?Q(n.top):I(1):k?F(!0):I(-1)};return window.addEventListener("wheel",e,{passive:!1}),()=>window.removeEventListener("wheel",e)},[c.length]),r.useEffect(()=>{const e=p.current;if(!e)return;const t=i=>{re(p.current)&&(oe.current=i.touches[0]?.clientY||0,B.current=0)},n=i=>{if(!re(p.current))return;if(v.current){i.preventDefault();return}const l=i.touches[0]?.clientY||0;B.current=oe.current-l,i.preventDefault()},o=()=>{if(!re(p.current)||v.current)return;const i=B.current;if(B.current=0,Math.abs(i)<Ne)return;const l=p.current.getBoundingClientRect(),d=l.top>C,R=Math.abs(l.top)<=C;return i>0?d?Q(l.top):I(1):R?F(!0):I(-1)};return e.addEventListener("touchstart",t,{passive:!0}),e.addEventListener("touchmove",n,{passive:!1}),e.addEventListener("touchend",o,{passive:!0}),e.addEventListener("touchcancel",o,{passive:!0}),()=>{e.removeEventListener("touchstart",t),e.removeEventListener("touchmove",n),e.removeEventListener("touchend",o),e.removeEventListener("touchcancel",o)}},[c.length]),r.useEffect(()=>{if(!w.current.length)return;const e=new IntersectionObserver(t=>{for(const n of t){if(!n.isIntersecting)continue;const o=Number(n.target.getAttribute("data-idx"));Number.isNaN(o)||(v.current?T.current=o:M(o))}},{root:null,rootMargin:"-48% 0px -48% 0px",threshold:[.01]});return w.current.forEach((t,n)=>{t&&(t.setAttribute("data-idx",String(n)),e.observe(t))}),be.current=e,()=>e.disconnect()},[c.length]);function Q(e){se(!0),H.current&&clearTimeout(H.current),H.current=setTimeout(()=>se(!1),900),v.current=!0,window.scrollTo({top:window.scrollY+e,behavior:"smooth"}),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{v.current=!1},420)}function I(e){const t=window.innerHeight,n=he(w.current,t),o=ne(n+e,0,c.length-1);if(o===n)return;const i=w.current[o];if(!i)return;v.current=!0;const l=window.scrollY+i.getBoundingClientRect().top;T.current=o,window.scrollTo({top:l,behavior:"smooth"}),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{v.current=!1;const d=Number.isInteger(T.current)?T.current:o;T.current=null,M(d)},420)}function F(e=!1){e&&X(!0),v.current=!0,T.current=0,window.scrollTo({top:0,behavior:"smooth"}),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{v.current=!1;const t=Number.isInteger(T.current)?T.current:0;T.current=null,M(t),e&&window.scrollY>ie&&X(!1)},500)}function M(e){if(e===U.current){ae(e);return}U.current=e,O(e),requestAnimationFrame(()=>ae(e))}function ae(e){const t=w.current[e];if(!t)return;let n=t.querySelector("[data-card]")||t.querySelector('a[href],button,textarea,input,select,[tabindex]:not([tabindex="-1"])');n||(n=t),n.getAttribute&&n.getAttribute("tabindex")===null&&n.tagName==="DIV"&&n.setAttribute("tabindex","0");try{n.focus({preventScroll:!0})}catch{n.focus()}}function Le(e,t){const n=t/2,o=w.current[U.current],i=w.current[e];if(!i)return M(e);const l=Math.abs(V(i)-n),d=o?Math.abs(V(o)-n):1/0,R=t/2*Te;l+R<d&&M(e)}function Ae(e){const t=window.innerHeight,n=w.current[e];if(!t||!n)return e===U.current;const o=t/2;return Math.abs(V(n)-o)<=t/2*Re}const ee="left-1/2 -translate-x-1/2",ue={left:te},Ce={left:te+G/2};return s.jsxs("section",{ref:p,className:`relative z-10 w-full ${j}`,"aria-label":"Timeline",children:[s.jsx("div",{className:"pointer-events-none absolute inset-0",children:s.jsxs("div",{className:"sticky top-0 h-screen w-full",children:[s.jsx("div",{className:`absolute bg-[#374151] ${N?"":ee}`,style:{...N?ue:{},top:A,height:`calc(100vh - ${A}px)`,width:`${G}px`},"aria-hidden":!0}),s.jsx("div",{className:`absolute ${N?"":ee}`,style:{...N?ue:{},...N?{bottom:"50%"}:{top:A},height:z,width:`${G}px`,background:ce,boxShadow:`0 0 10px ${De(ce,.55)}`},"aria-hidden":!0}),s.jsxs("div",{className:`absolute top-1/2 -translate-y-1/2 ${N?"-translate-x-1/2":ee}`,style:{...N?Ce:{},width:g,height:g},"aria-hidden":!0,children:[s.jsx("div",{className:"absolute -inset-2 rounded-full blur-md opacity-70 animate-pulse pointer-events-none z-10",style:{backgroundColor:u}}),s.jsx("div",{className:"absolute inset-0 rounded-full shadow-[0_0_6px_1px_rgba(0,0,0,0.25)] z-20",style:{backgroundColor:u}})]})]})}),s.jsx("div",{role:"list",children:c.map((e,t)=>{const n=Ae(t)||t===0&&ve,o=t===D,i=e.href?"a":"div",l=e.href?{href:e.href,target:e.target||"_blank",rel:"noopener noreferrer","aria-label":e.ariaLabel||`Open ${e.title||e.date}`}:{},d=t===0,R=ne(Y,0,1),$=d&&(ge||q)?b*R:0;return s.jsx("article",{ref:k=>w.current[t]=k,role:"listitem",className:"min-h-screen w-full","data-idx":t,children:s.jsxs("div",{className:"grid min-h-screen w-full items-center md:grid-cols-2",style:N?{paddingLeft:Z}:void 0,children:[s.jsx("div",{className:"hidden md:flex justify-end pr-8",children:s.jsx("time",{className:`select-none font-sans text-xl md:text-2xl transition-opacity z-20 ${n?"text-white/80":"text-white/50"}`,children:e.date})}),s.jsx("div",{className:"md:pl-8",children:s.jsxs(i,{...l,ref:d?L:null,"data-card":!0,"aria-current":o?"step":void 0,tabIndex:o?0:-1,className:`block rounded-2xl bg-[#0c1a22]/85 text-[#e0e0e0] shadow-xl backdrop-blur-sm px-4 py-3 select-none
                                transition-[opacity,transform] duration-300 will-change-transform
                                outline-none ring-0 focus:outline-none focus:ring-0 focus-visible:outline-none focus-visible:ring-0
                                ${n?"opacity-100":"opacity-70"}
                                ${e.href?"cursor-pointer hover:opacity-100 focus:opacity-100":""}`,style:{width:E,transform:`translateY(${$}px)`,WebkitTapHighlightColor:"transparent"},children:[N&&e.date?s.jsx("time",{className:"block mb-1 text-sm font-medium tracking-wide text-white/70",children:e.date}):null,e.title?s.jsx("h3",{className:"mb-2 font-bahnschrift text-2xl md:text-3xl text-[#f8da9c]",children:e.title}):null,s.jsx("p",{className:"text-base sm:text-lg md:text-xl lg:text-2xl leading-snug",children:e.body}),e.href?s.jsx("p",{className:"mt-2 text-sm text-white/60",children:"Click to learn more"}):null,e.image?.src?s.jsx("img",{src:e.image.src,alt:e.image.alt||"",loading:"lazy",className:"mt-3 w-full h-auto rounded-2xl object-cover"}):null]})})]})},e.id||t)})}),s.jsx("button",{type:"button",onClick:()=>F(!0),"aria-label":"Back to top",className:`fixed bottom-6 right-6 z-50 text-white/80 transition-opacity duration-200
                    ${pe?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"} 
                    hover:text-white focus:outline-none focus:ring-0`,style:{background:"transparent",border:"none"},children:s.jsx(Me,{className:"h-6 w-6 animate-bounce","aria-hidden":!0})})]})}function ne(c,a,f){return Math.max(a,Math.min(f,c))}function V(c){const a=c.getBoundingClientRect();return a.top+a.height/2}function he(c,a){const f=a/2;let u=0,h=1/0;return c.forEach((g,x)=>{if(!g)return;const j=Math.abs(V(g)-f);j<h&&(h=j,u=x)}),u}function De(c,a=1){const f=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(c);if(!f)return`rgba(64,213,209,${a})`;const u=parseInt(f[1],16),h=parseInt(f[2],16),g=parseInt(f[3],16);return`rgba(${u},${h},${g},${a})`}function Pe(c,a,f={}){const{isNarrow:u=!1,mobileLeftReserve:h=0,rightGutter:g=16}=f,x=32,j=G;if(u){const p=Math.max(220,c-h-g);return Math.min(a,p)}const Y=Math.max(220,c/2-x-j);return Math.min(a,Y)}function He(c,a){return a+c/2+8+12}function re(c){if(!c)return!1;const a=c.getBoundingClientRect();return a.top<window.innerHeight&&a.bottom>0}const Oe="https://raw.githubusercontent.com/Yejoon1025/rise-content/main/News.json";function We(){const c=r.useRef(null),[a,f]=r.useState(!0),u=a?de:fe,[h,g]=r.useState(0),[x,j]=r.useState([u,u]),[Y,p]=r.useState([]),[w,L]=r.useState(!0),[D,O]=r.useState(null);return r.useEffect(()=>{if(x[h]===u)return;let S=!1;const b=1-h,y=new Image;y.src=u;const A=async()=>{if(!S){try{y.decode&&await y.decode()}catch{}j(W=>{const z=[...W];return z[b]=u,z}),requestAnimationFrame(()=>{S||g(b)})}};return y.complete?A():y.onload=A,()=>{S=!0,y.onload=null}},[u,h,x]),r.useEffect(()=>{const E=()=>f(window.scrollY<=0);return window.addEventListener("scroll",E,{passive:!0}),()=>window.removeEventListener("scroll",E)},[]),r.useEffect(()=>{const E=new AbortController;async function S(){try{L(!0),O(null);const b=await fetch(Oe,{signal:E.signal});if(!b.ok)throw new Error(`Failed to load news: ${b.status} ${b.statusText}`);const y=await b.json();p(y)}catch(b){if(b.name==="AbortError")return;console.error(b),O("Could not load news timeline.")}finally{L(!1)}}return S(),()=>E.abort()},[]),s.jsxs("div",{className:"relative min-h-screen w-full",children:[s.jsxs("div",{className:"fixed inset-0 z-1 bg-[#0c1a22] overflow-hidden",children:[s.jsx("img",{"aria-hidden":!0,alt:"",decoding:"async",src:x[0],className:`h-full w-full object-cover absolute inset-0 transition-opacity duration-700 ease-in-out will-change-[opacity] ${h===0?"opacity-100":"opacity-0"}`,style:{objectPosition:"center"}}),s.jsx("img",{"aria-hidden":!0,alt:"",decoding:"async",src:x[1],className:`h-full w-full object-cover absolute inset-0 transition-opacity duration-700 ease-in-out will-change-[opacity] ${h===1?"opacity-100":"opacity-0"}`,style:{objectPosition:"center"}})]}),s.jsx("header",{className:"relative z-30 transition-opacity duration-500",style:{opacity:a?1:0},children:s.jsx(_e,{})}),s.jsx("section",{className:"relative z-20 flex min-h-[40vh] items-center justify-center px-6",children:s.jsx("h1",{className:"font-bahnschrift text-4xl md:text-6xl text-[#e0e0e0] px-6 text-center leading-tight absolute top-[30vh]",children:"The Rise Reforming Timeline"})}),s.jsxs("section",{ref:c,className:"relative z-10",children:[w&&s.jsx("div",{className:"py-10 text-center text-sm text-gray-300",children:"Loading timelineâ€¦"}),D&&s.jsx("div",{className:"py-10 text-center text-sm text-red-400",children:D}),!w&&!D&&s.jsx(Ye,{items:Y,backgroundUrl:de,overlayUrl:fe,color:"#3ca6a6",dotSize:12,cardWidth:420})]})]})}export{We as default};
