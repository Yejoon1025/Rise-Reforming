import{r as t,j as l}from"./index-DmrSB5xX.js";import{r as Y}from"./MobileNavbar-D-RXX42B.js";import{X as be}from"./x-DTZSE9jp.js";const q=t.createContext(null);function ve({children:E,threshold:j=.3,openOnDown:g="next"}){const a=t.useRef(new Map),D=t.useCallback((n,s)=>{const r=a.current.get(n)||{isVisible:!1,isOpen:()=>!1,open:()=>{},close:()=>{}};return a.current.set(n,{...r,...s}),()=>{a.current.delete(n)}},[]),k=t.useCallback(n=>{a.current.delete(n)},[]),S=t.useCallback((n,s)=>{const r=a.current.get(n);r?r.isVisible=!!s:a.current.set(n,{isVisible:!!s,isOpen:()=>!1,open:()=>{},close:()=>{}})},[]),i=t.useCallback(()=>{const n=[];for(const[s,r]of a.current.entries())r?.isVisible&&n.push([s,r]);return n},[]),N=t.useCallback(()=>i().length>0,[i]),R=t.useCallback(()=>{const n=i();return n.length?n.every(([,s])=>s.isOpen?.()):!1},[i]),w=t.useCallback(()=>{const n=i();if(!n.length)return!1;let s=!1;for(const[,r]of n)r.isOpen?.()||(r.open?.(),s=!0);return s},[i]),h=t.useCallback(()=>{const n=i();if(!n.length)return!1;const s=n.find(([,r])=>!r.isOpen?.())||n[0];return s?(s[1].open?.(),!0):!1},[i]),v=t.useCallback(()=>{g==="all"?w():h()},[w,h,g]),f=t.useCallback(()=>!1,[]),x=t.useCallback(()=>!1,[]),b=t.useCallback(()=>{},[]),d=t.useCallback(()=>!0,[]),m=t.useMemo(()=>({register:D,unregister:k,setVisible:S,hasVisibleDots:N,areAllVisibleOpen:R,openNextVisibleUnopened:h,openAllVisible:w,tryTriggerOpen:v,presentOverlay:f,replaceOverlay:x,dismissOverlay:b,threshold:j,openOnDown:g,isProviderActive:d}),[D,k,S,N,R,h,w,v,f,x,b,j,g,d]);return l.jsx(q.Provider,{value:m,children:E})}function me(){const E=t.useContext(q);if(!E)throw new Error("useGlowDotController must be used inside <GlowDotMobileProvider>");return E}const ye=t.forwardRef(function(j,g){const{top:a="50%",left:D="50%",size:k=10,color:S="#3ca6a6",title:i,text:N="Sample fact text goes here.",boxWidth:R=300,className:w="",ariaLabel:h="Info dot",fadeMs:v=220,dotId:f,boxNumber:x,absolutePx:b=!1,absX:d=null,absY:m=null}=j,{register:n,setVisible:s,threshold:r}=me(),y=t.useRef(null),[C,c]=t.useState(!1),[P,z]=t.useState(!1),[I,A]=t.useState(!1),[L,T]=t.useState(!1),o=t.useRef(null),V=t.useRef(!1);function F(){c(e=>{const u=!e;return e&&!u&&(T(!0),o.current&&(clearTimeout(o.current),o.current=null)),u})}function J(e){V.current=!0,F(),e.preventDefault(),e.stopPropagation()}function Q(e){if(V.current){V.current=!1;return}}function Z(e){(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),F())}t.useEffect(()=>{if(C)z(!0),requestAnimationFrame(()=>A(!0));else{A(!1);const e=setTimeout(()=>z(!1),v);return()=>clearTimeout(e)}},[C,v]);function G(e){return typeof e=="number"?`${e}px`:e}const _={top:G(a),left:G(D),width:`${k}px`,height:`${k}px`,transform:"translate(-50%, -50%)"},[$,B]=t.useState(null);function ee(){if(!(b&&Number.isFinite(d)&&Number.isFinite(m)))return null;const e=y.current?.offsetParent;if(e&&e instanceof HTMLElement){const u=e.getBoundingClientRect();return{left:d-u.left,top:m-u.top}}return{left:d,top:m}}t.useEffect(()=>{if(!(b&&Number.isFinite(d)&&Number.isFinite(m))){B(null);return}const e=()=>B(ee());return e(),window.addEventListener("resize",e),window.addEventListener("scroll",e,{passive:!0}),()=>{window.removeEventListener("resize",e),window.removeEventListener("scroll",e)}},[b,d,m]);const te=b&&$?{..._,top:`${$.top}px`,left:`${$.left}px`}:_,[p,ne]=t.useState({w:0,h:0});t.useEffect(()=>{const e=()=>ne({w:window.innerWidth,h:window.innerHeight});return e(),window.addEventListener("resize",e),window.addEventListener("orientationchange",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}},[]);const[,se]=t.useState(0);t.useEffect(()=>{if(!P)return;const e=()=>se(u=>(u+1)%1e6);return window.addEventListener("scroll",e,{passive:!0}),()=>window.removeEventListener("scroll",e)},[P]);function re(){const e=y.current?.getBoundingClientRect();return e?{cx:e.left+e.width/2,cy:e.top+e.height/2}:null}const H=I?"opacity-100":"opacity-0",U={transition:`opacity ${v}ms ease`},oe=I?"pointer-events-auto":"pointer-events-none",O=t.useRef(C);t.useEffect(()=>{O.current=C},[C]);const M=t.useRef(L);t.useEffect(()=>{M.current=L},[L]),t.useImperativeHandle(g,()=>({open:()=>c(!0),close:()=>c(!1),isOpen:()=>O.current}),[]),t.useEffect(()=>f?n(f,{open:()=>c(!0),close:()=>c(!1),isOpen:()=>O.current,getRect:()=>y.current?.getBoundingClientRect()??null}):void 0,[f,n]),t.useEffect(()=>{if(!y.current||!f)return;const e=500,u=new IntersectionObserver(xe=>{const K=xe[0],X=K.isIntersecting&&K.intersectionRatio>=r;s(f,X),X?(o.current&&(clearTimeout(o.current),o.current=null),!M.current&&!O.current&&(o.current=setTimeout(()=>{!M.current&&!O.current&&c(!0)},e))):(o.current&&(clearTimeout(o.current),o.current=null),c(!1),T(!1))},{threshold:r});return u.observe(y.current),()=>{u.disconnect(),o.current&&(clearTimeout(o.current),o.current=null)}},[f,s,r]);const W=re(),le=W?.cx??0,ie=W?.cy??0,ce=p.w/2,ue=p.h/2,ae={backgroundColor:S},fe={backgroundColor:S},de=P&&p.w>0&&p.h>0?Y.createPortal(l.jsx("svg",{className:`fixed inset-0 pointer-events-none z-10 ${H}`,style:U,width:p.w,height:p.h,viewBox:`0 0 ${p.w} ${p.h}`,children:l.jsx("line",{x1:le,y1:ie,x2:ce,y2:ue,stroke:"#374151",strokeWidth:"1.25",strokeLinecap:"round"})}),document.body):null,pe=P?Y.createPortal(l.jsx("div",{className:`fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 rounded-2xl bg-[#0c1a22]/85 text-white/90 z-40 ${H} ${oe}`,style:{width:R,...U},children:l.jsxs("div",{className:"relative p-4 pt-3 pr-3",children:[l.jsx("button",{type:"button","aria-label":"Close textbox",className:"absolute top-2 right-2 inline-flex h-7 w-7 items-center justify-center rounded-md",style:{color:"#a9b3b8"},onClick:e=>{e.stopPropagation(),T(!0),o.current&&(clearTimeout(o.current),o.current=null),c(!1)},onMouseDown:e=>e.stopPropagation(),onTouchStart:e=>e.stopPropagation(),children:l.jsx(be,{className:"h-4 w-4"})}),l.jsx("div",{className:"h-4"}),i&&l.jsx("p",{className:"text-center text-base sm:text-lg md:text-xl lg:text-2xl leading-snug text-[#f8da9c]",children:i}),N&&l.jsx("p",{className:"text-center text-base sm:text-lg md:text-xl lg:text-2xl leading-snug",children:N})]})}),document.body):null;return l.jsxs("div",{ref:y,className:`absolute ${w}`,style:te,children:[de,l.jsx("div",{className:"absolute -inset-2 rounded-full blur-md opacity-70 animate-pulse pointer-events-none z-20",style:fe}),l.jsx("button",{type:"button",className:"absolute inset-0 rounded-full shadow-[0_0_6px_1px_rgba(0,0,0,0.25)] outline-none focus:outline-none z-30",style:ae,"aria-label":h,"aria-expanded":C,onMouseEnter:()=>c(!0),onFocus:()=>c(!0),onClick:Q,onTouchStart:J,onKeyDown:Z}),x!=null&&String(x).length>0&&l.jsx("div",{className:"absolute left-1/2 top-full -translate-x-1/2 mt-1 z-40",children:l.jsx("span",{className:"inline-flex h-6 min-w-6 px-2 items-center justify-center rounded-full bg-[#0c1a22]/85 text-white/90 text-xs font-medium pointer-events-none",children:String(x)})}),pe]})});export{ve as G,ye as a};
