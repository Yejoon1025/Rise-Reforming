import{r as e,j as Q}from"./index-eUpme5BV.js";const Z=e.createContext(null);function ce({children:g,threshold:S=.3,openOnDown:m="next",useViewportGuard:C=!0,viewportThreshold:V=.05,viewportRootMargin:Y="0px"}){const d=e.useRef(new Map),X=e.useRef(0),$=220,a=e.useRef(!0),i=e.useRef(!1),o=e.useRef(!1),w=e.useRef(0),ee=e.useRef(0),x=e.useRef(!1),O=e.useRef(0),A=e.useRef(0),N=e.useRef(null),D=e.useRef(!0),W=.25,_=20,G=40,c=e.useCallback(()=>C?!!D.current:!0,[C]),j=e.useCallback((t,n)=>{const s=d.current.get(t)||{isVisible:!1,isOpen:()=>!1,open:()=>{},close:()=>{}};return d.current.set(t,{...s,...n}),()=>{d.current.delete(t)}},[]),H=e.useCallback(t=>{d.current.delete(t)},[]),K=e.useCallback((t,n)=>{const s=d.current.get(t),v=!!s?.isVisible;s?s.isVisible=!!n:d.current.set(t,{isVisible:!!n,isOpen:()=>!1,open:()=>{},close:()=>{}});const l=d.current.get(t);n&&!v&&(!l?.isOpen||!l.isOpen())&&(a.current=!1,o.current=!0)},[]),p=e.useCallback(()=>{const t=[];for(const[n,s]of d.current.entries())s?.isVisible&&t.push([n,s]);return t},[]),h=e.useCallback(()=>p().length>0,[p]),u=e.useCallback(()=>{const t=p();return t.length?t.every(([,n])=>n.isOpen?.()):!1},[p]),k=e.useCallback(()=>{const t=p();if(!t.length)return!1;let n=!1;for(const[,s]of t)s.isOpen?.()||(s.open?.(),n=!0);return n},[p]),y=e.useCallback(()=>{const t=p();if(!t.length)return!1;const n=t.find(([,s])=>!s.isOpen?.())||t[0];return n?(n[1].open?.(),!0):!1},[p]),U=e.useCallback(()=>c()&&h()&&!u(),[c,h,u]),F=e.useCallback(()=>c()&&h()&&(!u()||i.current),[c,h,u]),T=e.useCallback(()=>c()&&(o.current||F()),[c,F]),b=e.useCallback(()=>{const t=Date.now();t-X.current<$||(X.current=t,m==="all"?k():y(),a.current=!1,u()&&(i.current=!0,o.current=!0))},[m,k,y,u]);e.useEffect(()=>{if(!C){D.current=!0;return}const t=N.current;if(!t)return;const n=new IntersectionObserver(s=>{const v=s[0],l=!!v?.isIntersecting&&(v.intersectionRatio??0)>0;D.current=l,l||(o.current=!1,i.current=!1,a.current=!0,w.current=0)},{threshold:V,rootMargin:Y});return n.observe(t),()=>n.disconnect()},[C,V,Y]),e.useEffect(()=>{function t(r){r.defaultPrevented||c()&&r.key==="ArrowDown"&&U()&&(r.preventDefault(),r.stopImmediatePropagation?.(),r.stopPropagation(),b())}function n(r){if(r.defaultPrevented||!c())return;const f=Math.abs(r.deltaX),E=Math.abs(r.deltaY);if(E<=f||r.deltaY<=0)return;const M=performance.now(),R=w.current||0,L=R+(E-R)*W;w.current=L,ee.current=M;const P=L<_,I=E>=G;if(o.current&&u()&&(i.current=!0),!!T())if(o.current=!0,r.preventDefault(),r.stopImmediatePropagation?.(),r.stopPropagation(),P){if(a.current=!0,u()&&i.current){i.current=!1,o.current=!1;return}}else I&&a.current&&(b(),a.current=!1)}function s(r){if(r.defaultPrevented||!c()||r.touches.length!==1)return;const f=r.touches[0];x.current=!0,O.current=f.clientY,A.current=f.clientX,w.current=0}function v(r){if(r.defaultPrevented||!c()||!x.current||r.touches.length!==1)return;const f=r.touches[0],E=O.current-f.clientY,M=A.current-f.clientX,R=Math.abs(E),L=Math.abs(M);if(O.current=f.clientY,A.current=f.clientX,R<=L||E<=0)return;const P=w.current||0,I=P+(R-P)*W;w.current=I;const J=I<_,re=R>=G;if(o.current&&u()&&(i.current=!0),!!T())if(o.current=!0,r.preventDefault(),r.stopImmediatePropagation?.(),r.stopPropagation(),J){if(a.current=!0,u()&&i.current){i.current=!1,o.current=!1;return}}else re&&a.current&&(b(),a.current=!1)}function l(){x.current=!1,i.current||(o.current=!1)}return window.addEventListener("keydown",t,{capture:!0}),window.addEventListener("wheel",n,{capture:!0,passive:!1}),window.addEventListener("touchstart",s,{capture:!0,passive:!1}),window.addEventListener("touchmove",v,{capture:!0,passive:!1}),window.addEventListener("touchend",l,{capture:!0}),window.addEventListener("touchcancel",l,{capture:!0}),()=>{window.removeEventListener("keydown",t,{capture:!0}),window.removeEventListener("wheel",n,{capture:!0}),window.removeEventListener("touchstart",s,{capture:!0}),window.removeEventListener("touchmove",v,{capture:!0}),window.removeEventListener("touchend",l,{capture:!0}),window.removeEventListener("touchcancel",l,{capture:!0})}},[c,U,T,u,b]);const q=e.useCallback(()=>!1,[]),z=e.useCallback(()=>!1,[]),B=e.useCallback(()=>{},[]),te=e.useMemo(()=>({register:j,unregister:H,setVisible:K,hasVisibleDots:h,areAllVisibleOpen:u,openNextVisibleUnopened:y,openAllVisible:k,tryTriggerOpen:b,presentOverlay:q,replaceOverlay:z,dismissOverlay:B,threshold:S,openOnDown:m,isProviderActive:c}),[j,H,K,h,u,y,k,b,q,z,B,S,m,c]);return Q.jsx("div",{ref:N,"data-glow-root":!0,children:Q.jsx(Z.Provider,{value:te,children:g})})}function ue(){const g=e.useContext(Z);if(!g)throw new Error("useGlowDotController must be used inside <GlowDotProvider>");return g}export{ce as G,ue as u};
